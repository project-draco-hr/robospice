{
  spiceManager.start(getInstrumentation().getTargetContext());
  SpiceRequestStub<String> spiceRequestStub=new SpiceRequestFailingStub<String>(TEST_CLASS,WAIT_BEFORE_EXECUTING_REQUEST_LARGE);
  SpiceRequestStub<String> spiceRequestStub2=new SpiceRequestFailingStub<String>(TEST_CLASS,WAIT_BEFORE_EXECUTING_REQUEST_LARGE);
  RequestListenerWithProgressStub<String> requestListenerStub=new RequestListenerWithProgressStub<String>();
  RequestListenerWithProgressStub<String> requestListenerStub2=new RequestListenerWithProgressStub<String>();
  spiceManager.execute(spiceRequestStub,TEST_CACHE_KEY,TEST_DURATION,requestListenerStub);
  spiceManager.execute(spiceRequestStub2,TEST_CACHE_KEY2,TEST_DURATION,requestListenerStub2);
  spiceManager.cancelAllRequests();
  spiceRequestStub.awaitForLoadDataFromNetworkIsCalled(REQUEST_COMPLETION_TIME_OUT);
  spiceRequestStub2.awaitForLoadDataFromNetworkIsCalled(REQUEST_COMPLETION_TIME_OUT);
  assertTrue(spiceRequestStub.isCancelled());
  assertTrue(spiceRequestStub2.isCancelled());
  assertTrue(requestListenerStub.isComplete());
  assertTrue(requestListenerStub2.isComplete());
  assertFalse(requestListenerStub.isSuccessful());
  assertFalse(requestListenerStub2.isSuccessful());
  assertTrue(requestListenerStub.getReceivedException() instanceof RequestCancelledException);
  assertTrue(requestListenerStub2.getReceivedException() instanceof RequestCancelledException);
}
