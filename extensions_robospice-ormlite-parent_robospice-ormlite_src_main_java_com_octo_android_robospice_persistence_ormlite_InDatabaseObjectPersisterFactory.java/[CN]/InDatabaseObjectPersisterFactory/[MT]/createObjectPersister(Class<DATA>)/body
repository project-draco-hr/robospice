{
  initializeTablesIfNeeded();
  Class<?> idType;
  try {
    idType=getIdType(clazz);
  }
 catch (  SQLException e) {
    throw new RuntimeException("Impossible to determine the type of the ID used in class " + clazz.getName(),e);
  }
  return new InDatabaseObjectPersister(getApplication(),databaseHelper,clazz,idType);
}
