{
  try {
    final HttpURLConnection httpURLConnection=(HttpURLConnection)new URL(url).openConnection();
    InputSupplier<InputStream> supplier=new InputSupplier<InputStream>(){
      public InputStream getInput() throws IOException {
        return httpURLConnection.getInputStream();
      }
    }
;
    long total=httpURLConnection.getContentLength();
    cacheFile.setLastModified(System.currentTimeMillis());
    OutputStream fileOutputStream=new FileOutputStream(cacheFile);
    ByteStreams.readBytes(supplier,new ProgressByteProcessor(fileOutputStream,total));
    return new FileInputStream(cacheFile);
  }
 catch (  MalformedURLException e) {
    Ln.e(e,"Unable to create image URL");
    return null;
  }
catch (  IOException e) {
    Ln.e(e,"Unable to download image");
    return null;
  }
}
